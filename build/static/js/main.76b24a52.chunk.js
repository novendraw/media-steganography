(this.webpackJsonpuntitled=this.webpackJsonpuntitled||[]).push([[0],{40:function(e,t,a){e.exports=a(62)},45:function(e,t,a){},54:function(e,t){},62:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(18),s=a.n(l),o=(a(45),a(68)),i=a(65),u=a(31),c=a(69),m=a(64);var d=function(){return r.a.createElement(m.a,{className:"background-navy border-radius-0 padding-0"},r.a.createElement("div",{className:"content-center-grid margin-bottom-md"},r.a.createElement("div",{className:"heading-2 bold white"},"Media Steganography"),r.a.createElement("div",{className:"content-center subheadline bold white"},"with LSB and BPCS")),r.a.createElement("div",{className:"content-center body-text white padding-bottom-sm"},"by Eka Novendra Wahyunadi (13517011), Nixon Andhika (13517059), and Ferdy Santoso (13517116)"))},h=a(7),g=a(8),f=a(17),v=a(16),p=a(67),E=a(66);function b(e){for(var t=[],a=0;a<e.length;a++){var n=e.charCodeAt(a);t.push(n)}return t}function y(e,t){for(var a=new Uint8Array(e.length),n=b(t),r=0;r<e.length;r++){var l=e[r];l=((l+n[r%n.length])%256+256)%256,a[r]=l}return a}function k(e,t){for(var a=new Uint8Array(e.length),n=b(t),r=0;r<e.length;r++){var l=e[r];l=((l-n[r%n.length])%256+256)%256,a[r]=l}return a}function S(e){for(var t=new Uint8Array(e.length),a=0;a<e.length;a++)t[a]=e.charCodeAt(a);return t}function x(e){for(var t="",a=0;a<e.length;a++){var n=e[a].toString(2);t+=n="00000000".substr(n.length)+n}return t}function C(e){for(var t=A(e),a=new Uint8Array(t.length/8),n=0;t.length>0;){var r=t.substr(0,8);a[n]=parseInt(r,2),t=t.substring(8),n++}return a}function w(e){var t=e,a=new Uint8Array(t.length/8),n=0;for(console.log(a);t.length>0;){var r=t.substr(0,8);a[n]=parseInt(r,2),t=t.substring(8),n++}return a}function I(e){for(var t="",a=0;a<e.length;a++){var n=e.charCodeAt(a).toString(2);t+=n="00000000".substr(n.length)+n}return t}function N(e){for(var t=A(e),a="";t.length>0;){var n=t.substr(0,8);a+=String.fromCharCode(parseInt(n,2)),t=t.substring(8)}return a}function R(e){for(var t=new Uint8Array(e.length),a=0;a<e.length;a++)t[a]=parseInt(e[a],2);return t}function L(e){var t=[],a=x(e),n=a.length%64;if(0!==n){var r="0";a=(r=r.repeat(64-n))+a}for(;a.length>0;){for(var l=[],s=a.substr(0,64),o=0;o<s.length;o++)l.push(s[o]);t.push(l),a=a.substring(64)}return t}function U(e){for(var t=new Uint8Array(8*e.length),a=0,n=0;n<e.length;n++)for(var r=0;r<64;r+=8){var l=e[n][r]+e[n][r+1]+e[n][r+2]+e[n][r+3]+e[n][r+4]+e[n][r+5]+e[n][r+6]+e[n][r+7];l=parseInt(l,2),t[a]=l,a++}return t}function j(e){var t=[],a=e.toString(2),n=a.length%64;if(0!==n){var r="0";a=(r=r.repeat(64-n))+a}for(var l=0;l<64;l++)t.push(a[l]);return t}function F(e){for(var t=!1,a="",n=0;n<e.length;n++)t?a+=e[n]:"1"===e[n]&&(t=!0,a+=e[n]);return t?parseInt(a,2):0}function A(e){var t=e.replace(/^0+/,""),a=t.length%8;if(0!==a){var n="0";t=(n=n.repeat(8-a))+t}return t}function M(e){return new Promise((function(t,a){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.onerror=a,n.readAsArrayBuffer(e)}))}function B(e){return new Promise((function(t,a){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.onerror=a,n.readAsDataURL(e)}))}function O(e,t){if(t){var a=new Blob([t],{type:"application/octet-stream"});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(a,e);else{var n=window.document.createElement("a");n.href=window.URL.createObjectURL(a),n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)}}else alert("No result yet!")}var D=a(9),P=a.n(D),V=function(e){Object(f.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).toggleEncryption=function(e){n.setState({useEncryption:e.target.checked})},n.saveFileName=function(e){n.setState({resultFileName:e.target.value})},n.renderImg=function(e){e.length>0?B(e[0]).then((function(e){n.setState({sourceImgURL:e})})):n.setState({sourceImgURL:null})},n.handleSubmit=function(e){e.preventDefault();var t=n.state.sourceImgURL,a=e.target.inputSourceImg,r=e.target.inputFile,l=e.target.methodOption.value,s=e.target.encryptKey.value,o=e.target.hidingOption.value;"lsb"===l?"hide"===n.action?a.files.length>0&&r.files.length>0?(n.setState({fileName:r.files[0].name}),n.LSBEmbed(t,r.files[0],s,o)):alert("Source Media and File to Hide Must Exist!"):a.files.length>0?n.getLSB(t,s):alert("Source Media to Extract Must Exist!"):"hide"===n.action?a.files.length>0&&r.files.length>0?(n.setState({fileName:r.files[0].name}),n.BPCSEmbed(t,r.files[0],s,o)):alert("Source Media and File to Hide Must Exist!"):a.files.length>0?n.getBPCS(t,s):n.getLSB(t,s)},n.action=null,n.state={fileName:"hidden.png",resultFileName:"result.png",chessboard:["0","1","0","1","0","1","0","1","1","0","1","0","1","0","1","0","0","1","0","1","0","1","0","1","1","0","1","0","1","0","1","0","0","1","0","1","0","1","0","1","1","0","1","0","1","0","1","0","0","1","0","1","0","1","0","1","1","0","1","0","1","0","1","0"],sourceImgURL:null,resultCanvas:null,resultImgURL:null,useEncryption:!1,psnr:null},n}return Object(g.a)(a,[{key:"getImageData",value:function(e){var t=document.createElement("canvas"),a=t.getContext("2d"),n=document.createElement("img");return n.src=e,t.width=n.width,t.height=n.height,a.drawImage(n,0,0),a.getImageData(0,0,n.width,n.height)}},{key:"LSBEmbed",value:function(e,t,a,n){var r=this,l=this.getImageData(e),s=l.data.length;M(t).then((function(t){var o=new Uint8Array(t),i=null,u=r.state.useEncryption;u?(o=y(o,a),i=Array.from(o),"random"===n&&(i=P.a.shuffle(i,a))):i=Array.from(o);var c=o.length;if(s>=1+8*c*8+16384){var m=r.state.fileName,d=null,h=2016-(d=u?x(d=y(d=S(m),a)):I(m)).length,g="0";d=(g=g.repeat(h))+d;var f=c.toString(2);f="00000000000000000000000000000000".substr(f.length)+f;var v=x(i);r.setState({buffer:v});for(var p=[],E=0;E<s;E++){var b=l.data[E].toString(2);E<1?b=u&&"random"===n?b.substr(0,b.length-1)+"0":b.substr(0,b.length-1)+"1":E<2017?b=b.substr(0,b.length-1)+d[E-1]:E<2049?b=b.substr(0,b.length-1)+f[E-2017]:E<2049+8*c&&(b=b.substr(0,b.length-1)+v[E-2049]),p.push(b)}p=R(p),r.renderResultImg(e,p)}else alert("Source capacity is not enough")}))}},{key:"getLSB",value:function(e,t){var a=this.getImageData(e),n=a.data.length,r="",l=a.data[0].toString(2),s=null;s="1"===l[l.length-1]?"sequence":"random";for(var o=1;o<2049&&o<n;o++){var i=a.data[o].toString(2);r+=i[i.length-1]}var u=r.substr(0,2016),c=this.state.useEncryption;u=c?function(e){for(var t="",a=0;a<e.length;a++)t+=String.fromCharCode(e[a]);return t}(u=k(u=C(u),t)):N(u);var m=r.substr(2016,2048);m=parseInt(m,2);var d=[];r="";for(var h=0;h<8*m;h++){var g=a.data[2049+h].toString(2),f=g[g.length-1];r.length<8?h===8*m-1?(r="00000000".substr(r.length)+r,d.push(r)):r+=f:(d.push(r),r=f)}var v=R(d);if(c&&"random"===s){var p=Array.from(v);v=P.a.unshuffle(p,t)}c&&(v=k(v,t)),O(u,v)}},{key:"calculateComplexity",value:function(e){for(var t=e.length,a=0,n=0;n<t;n++)"1"===e[n]&&(n-1>0&&(n-1)%8!==7&&e[n-1]!==e[n]&&a++,n+1<t&&(n+1)%8!==0&&e[n+1]!==e[n]&&a++,n-8>0&&e[n-8]!==e[n]&&a++,n+8<t&&e[n+8]!==e[n]&&a++);return a/112}},{key:"xor",value:function(e,t){return e===t?"0":"1"}},{key:"convertPBC_CGC",value:function(e,t){for(var a=[],n=e.length%8,r=0;r<e.length;r++)if(r<e.length-n)if(r%8===0)a.push(e[r]);else{for(var l=[],s=0;s<64;s++){var o=this.xor(e[r-1][s],e[r][s]);l.push(o)}"reverse"===t&&(e[r]=l),a.push(l)}else a.push(e[r]);return a}},{key:"conjugate",value:function(e){for(var t=this.state.chessboard,a=[],n=0;n<e.length;n++)a.push(this.xor(e[n],t[n]));return a}},{key:"BPCSEmbed",value:function(e,t,a,n){var r=this,l=this.getImageData(e);M(t).then((function(t){var s=new Uint8Array(t),o=S(r.state.fileName),i=null;i=j("sequence"===n?1:0);var u=j((o=L(o)).length),c=r.state.useEncryption;if(c&&(s=y(s,a),"random"===n)){var m=Array.from(s);s=P.a.shuffle(m,a)}for(var d=L(s),h=j(d.length),g=L(l.data),f=!1,v=!1,p=!1,E=0,b=[],x=0,C=[],w=[],I=[],R=0;R<g.length;R++){if(r.calculateComplexity(g[R])>.3)if(w.push(R),f)if(v)if(E<o.length)r.calculateComplexity(o[E])<=.3&&(b.push(E),o[E]=r.conjugate(o[E])),I.push(o[E]),E++;else if(p){if(x<d.length){if(r.calculateComplexity(d[x])>.3)I.push(d[x]);else{C.push(x);var A=r.conjugate(d[x]);I.push(A)}x++}}else r.calculateComplexity(h)<=.3&&(h=r.conjugate(h)),I.push(h),p=!0;else r.calculateComplexity(u)<=.3&&(u=r.conjugate(u)),I.push(u),v=!0;else r.calculateComplexity(i)<=.3&&(i=r.conjugate(i)),I.push(i),f=!0}if(w.length>=2+b.length+C.length+I.length){for(var M=0;M<w.length;M++)if(0===M){var B=j(b.length);r.calculateComplexity(B)<=.3&&(B=r.conjugate(B)),g[w[M]]=B}else if(M<b.length+1){var D=j(b[M-1]);r.calculateComplexity(D)<=.3&&(D=r.conjugate(D)),g[w[M]]=D}else if(M<b.length+2){var V=j(C.length);r.calculateComplexity(V)<=.3&&(V=r.conjugate(V)),g[w[M]]=V}else if(M<b.length+2+C.length){var G=j(C[M-(b.length+2)]);r.calculateComplexity(G)<=.3&&(G=r.conjugate(G)),g[w[M]]=G}else{if(!(M<b.length+2+C.length+I.length))break;var K=b.length+2+C.length;g[w[M]]=I[M-K]}var q=U(g);r.renderResultImg(e,q),g=L(q);for(var H=[],_=0;_<g.length;_++)r.calculateComplexity(g[_])>.3&&H.push(g[_]);for(var z=F(r.conjugate(H[0])),J=[],W=0;W<z;W++)J.push(F(r.conjugate(H[W+1])));for(var T=F(r.conjugate(H[1+J.length])),Y=2+J.length,$=[],Q=0;Q<T;Q++)$.push(F(r.conjugate(H[Q+Y])));Y+=$.length;var X=F(r.conjugate(H[Y]));X=1===X?"sequence":"random",Y++;var Z=F(r.conjugate(H[Y]));Y++;for(var ee=[],te=0;te<Z;te++)ee.push(H[te+Y]);Y+=ee.length;for(var ae="",ne=0;ne<ee.length;ne++){var re=ee[ne];J.includes(ne)&&(re=r.conjugate(re));for(var le="",se=0;se<64;se++)le+=re[se];ae+=N(le)}var oe=F(r.conjugate(H[Y]));Y++;for(var ie=[],ue=0;ue<oe;ue++)$.includes(ue)?ie.push(r.conjugate(H[ue+Y])):ie.push(H[ue+Y]);for(var ce=U(ie),me=!1,de=0,he=0;he<ce.length&&!me;he++)0!==ce[he]?me=!0:de++;for(var ge=new Uint8Array(ce.length-de),fe=de;fe<ce.length;fe++)ge[fe-de]=ce[fe];if(c){if("random"===n){var ve=Array.from(ge);ge=P.a.unshuffle(ve,a)}ge=k(ge,a)}O(ae,ge)}else alert("Source capacity is not enough")}))}},{key:"getBPCS",value:function(e,t){var a=L(this.getImageData(e).data);a=this.convertPBC_CGC(a,"normal");for(var n=[],r=0;r<a.length;r++)this.calculateComplexity(a[r])>.3&&n.push(a[r]);for(var l=F(this.conjugate(n[0])),s=[],o=0;o<l;o++)s.push(F(this.conjugate(n[o+1])));for(var i=F(this.conjugate(n[1+s.length])),u=2+s.length,c=[],m=0;m<i;m++)c.push(F(this.conjugate(n[m+u])));u+=c.length;var d=F(this.conjugate(n[u]));d=1===d?"sequence":"random",u++;var h=F(this.conjugate(n[u]));u++;for(var g=[],f=0;f<h;f++)g.push(n[f+u]);u+=g.length;for(var v="",p=0;p<g.length;p++){var E=g[p];s.includes(p)&&(E=this.conjugate(E));for(var b="",y=0;y<64;y++)b+=E[y];v+=N(b)}var S=F(this.conjugate(n[u]));u++;for(var x=[],C=0;C<S;C++)c.includes(C)?x.push(this.conjugate(n[C+u])):x.push(n[C+u]);for(var w=U(x),I=!1,R=0,j=0;j<w.length&&!I;j++)0!==w[j]?I=!0:R++;for(var A=new Uint8Array(w.length-R),M=R;M<w.length;M++)A[M-R]=w[M];if(this.state.useEncryption){if("random"===d){var B=Array.from(A);A=P.a.unshuffle(B,t)}A=k(A,t)}O(v,A)}},{key:"renderResultImg",value:function(e,t){var n=document.createElement("canvas"),r=n.getContext("2d"),l=document.createElement("img");l.src=e,n.width=l.width,n.height=l.height;var s=new Uint8ClampedArray(t),o=new ImageData(s,l.width,l.height);r.putImageData(o,0,0);var i=new a;i.src=n.toDataURL(),this.setState({resultImgURL:i.src,resultCanvas:n}),this.calculatePSNR(l.width,l.height,e,o)}},{key:"calculatePSNR",value:function(e,t,a,n){for(var r=0,l=this.getImageData(a),s=0;s<l.data.length;s++)r+=Math.pow(l.data[s]-n.data[s],2);var o=Math.sqrt(1/(e*t)*r),i=20*Math.log10(256/o);return i=Math.round(100*i)/100,this.setState({psnr:i}),i}},{key:"downloadFromCanvas",value:function(e,t){var a=document.createElement("a");a.download=e,t.toBlob((function(e){a.href=URL.createObjectURL(e),a.click()}),"application/octet-stream")}},{key:"render",value:function(){var e=this,t=this.state,a=t.sourceImgURL,n=t.resultCanvas,l=t.resultImgURL,s=t.useEncryption,o=t.psnr;return r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,{onSubmit:this.handleSubmit,className:"margin-bottom-md"},r.a.createElement(i.a,null,r.a.createElement(u.a,{xs:4,className:"content-start"},r.a.createElement("div",{className:"content-center subheadline bold margin-bottom-sm"},"Source Media"),r.a.createElement("div",{className:"content-center full-width image-container margin-bottom-xs"},r.a.createElement("img",{id:"sourceImg",src:a,className:"full-height"})),r.a.createElement(p.a.Group,null,r.a.createElement(p.a.File,{id:"inputSourceImg",label:"Upload source image",onChange:function(t){return e.renderImg(t.target.files)},accept:"image/x-png,image/bmp"}))),r.a.createElement(u.a,{xs:4},r.a.createElement("div",{className:"content-center subheadline bold margin-bottom-xxl"},"File to Hide"),r.a.createElement("div",{className:"body-text bold margin-bottom-sm"},"Choose file to hide within source image"),r.a.createElement(p.a.Group,null,r.a.createElement(p.a.File,{id:"inputFile"}))),r.a.createElement(u.a,{xs:4},r.a.createElement("div",{className:"content-center subheadline bold margin-bottom-sm"},"Result Media"),r.a.createElement("div",{className:"content-center full-width image-container margin-bottom-xs"},r.a.createElement("img",{id:"resultImg",src:l,className:"full-height"})),r.a.createElement(i.a,null,r.a.createElement("div",null,"Enter filename with extension")),r.a.createElement(i.a,null,r.a.createElement(u.a,{className:"no-indent"},r.a.createElement(p.a.Group,{controlId:"filenameField"},r.a.createElement(p.a.Control,{type:"text",onChange:function(t){e.saveFileName(t)}}))),r.a.createElement(u.a,{className:"no-indent"},r.a.createElement(E.a,{variant:"success",type:"button",className:"margin-bottom-xs",onClick:function(){return e.downloadFromCanvas(e.state.resultFileName,n)}}," ","Download Result"))),r.a.createElement(i.a,null,r.a.createElement("div",{className:"bold"},"PSNR: ",o||"-")))),r.a.createElement(i.a,null,r.a.createElement(u.a,null,r.a.createElement(p.a.Group,{controlId:"methodOption"},r.a.createElement(p.a.Label,null,"Method"),r.a.createElement(p.a.Control,{as:"select"},r.a.createElement("option",{value:"lsb"},"LSB"),r.a.createElement("option",{value:"bpcs"},"BPCS"))),r.a.createElement(p.a.Group,{controlId:"useEncryption"},r.a.createElement(p.a.Check,{type:"checkbox",label:"Use Encryption",onChange:this.toggleEncryption})),r.a.createElement(p.a.Group,{controlId:"encryptKey"},r.a.createElement(p.a.Label,null,"Encryption Key"),r.a.createElement(p.a.Control,{type:"text",readOnly:!s,ref:function(t){e.encryptKey=t}})),r.a.createElement(p.a.Group,{controlId:"hidingOption"},r.a.createElement(p.a.Label,null,"Hiding Option"),r.a.createElement(p.a.Control,{as:"select"},r.a.createElement("option",{value:"sequence"},"Sequential"),r.a.createElement("option",{value:"random"},"Random"))),r.a.createElement(E.a,{variant:"primary",type:"submit",className:"full-width margin-bottom-xs",onClick:function(){return e.action="hide"}}," ","Hide"),r.a.createElement(E.a,{variant:"info",type:"submit",className:"full-width",onClick:function(){return e.action="extract"}}," ","Extract")))))}}]),a}(r.a.PureComponent),G=a(37),K=a(27),q=function(e){Object(f.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).handleSubmit=function(e){e.preventDefault();var t,a,r,l=e.target.inputSourceVid,s=e.target.inputMessage;if("LSBEmbed"===n.action&&l.files.length>0&&s.files.length>0)t=s.files[0].name;else if("LSBEmbed"===n.action&&(l.files.length<=0||s.files.length<=0))return void alert("Source Media and Message Media must Exist!");if("LSBEmbed"===n.action&&l.files.length>0&&s.files.length>0||"LSBExtract"===n.action&&l.files.length>0){var o,i=n.state,u=i.sourceVid,c=i.message,m=e.target.frameOption.value,d=e.target.useEncryption.checked,h=e.target.hidingOption.value,g=e.target.key.value;"LSBExtract"===n.action&&(c=new File([""],"filename")),(a=u,r=c,Promise.all([M(a),M(r)])).then((function(e){var a=Object(G.a)(e,2),r=a[0],l=a[1],s=new Uint8Array(r),i=new Uint8Array(l);if("LSBEmbed"===n.action){if(d&&(null===g||""===g))return void alert("Encryption cancelled. Provide key for encryption.");if(("random"===h||"random"===m)&&(null===g||""===g))return void alert("Encryption cancelled. Provide key for random seed.");o=n.getSeedFromKey(g),n.setState({seed:o}),n.LSBEmbed(s,i,t,m,h,d,g,o)}else{if(d&&(null===g||""===g))return void alert("Decryption cancelled. Provide key for decryption.");if(("random"===h||"random"===m)&&(null===g||""===g))return void alert("Decryption cancelled. Provide key for random seed.");o=n.getSeedFromKey(g),n.setState({seed:o}),n.LSBExtract(s,d,g,o)}}))}else alert("Source Media and Message Media must Exist!")},n.renderVid=function(e,t){if(e.length>0){var a=e[0];B(a).then((function(e){"source"===t?n.setState({sourceVid:a,sourceVidURL:e}):"message"===t?n.setState({message:a,messageURL:e}):n.setState({resultVidURL:e})}))}else"source"===t?n.setState({sourceVid:null,sourceVidURL:null}):"message"===t?n.setState({message:null,messageURL:null}):n.setState({resultVid:null,resultVidURL:null})},n.toggleEncryption=function(e){n.setState({useEncryption:e.target.checked})},n.saveFileName=function(e){n.setState({resultFilename:e.target.value})},n.action=null,n.state={sourceVid:null,sourceVidURL:null,message:null,messageURL:null,resultVid:null,resultVidURL:null,seed:null,resultFilename:"",useEncryption:!1,psnrValue:null},n}return Object(g.a)(a,[{key:"LSBEmbed",value:function(e,t,a,n,r,l,s,o){var i=new K.a;i.setSignature(e),console.log(i.signature);for(var u=0,c=0;c<i.signature.subChunks.length;c++)if("LIST"===i.signature.subChunks[c].chunkId&&"movi"===i.signature.subChunks[c].format){u=c;break}for(var m=i.signature.subChunks[u].subChunks.length,d=[],h=0,g=0;g<m;g++)"d"===i.signature.subChunks[u].subChunks[g].chunkId[2]&&(d.push(i.signature.subChunks[u].subChunks[g]),h+=i.signature.subChunks[u].subChunks[g].chunkSize);var f=e,v=t.length;if(l&&(t=y(t,s)),"random"===n&&(d=P.a.shuffle(d,o)),8*v>h)alert("Source capacity is not enough");else{for(var p="",E=0;E<v;E++)p+=("000000000"+t[E].toString(2)).substr(-8);for(var b=0,k=0,S=[],x=[];b<p.length;){for(var C=[],N=d[k].chunkData.start;N<d[k].chunkData.end;N++)C.push(N);x.push(d[k].chunkSize),"random"===r&&(C=P.a.shuffle(C,o)),S=S.concat(C),b+=d[k].chunkSize,k+=1}for(var R=b-p.length,L=[],U=0;U<p.length;U++){var j=("000000000"+e[S[U]].toString(2)).substr(-8);j=j.substring(0,7)+p[U];var F=parseInt(j,2);L.push(Math.pow(Math.abs(f[S[U]]-F),2)),f[S[U]]=F}for(var A=0;A<R;A++)L.push(0);for(var M=0,B=0;B<i.signature.subChunks.length;B++)if("JUNK"===i.signature.subChunks[B].chunkId){M=B;break}var O=i.signature.subChunks[M].chunkData.start,D=(i.signature.subChunks[M].chunkData.end,"");D+="random"===n?"0":"1",D="000000"+(D+="random"===r?"0":"1"),D=parseInt(D,2),f[O]=D,M=O+1;for(var V=I(a);V.length<2016;)V="0"+V;for(var G=w(V),q=0;q<252;q++)f[M]=G[q],M+=1;for(var H=v.toString(2);H.length<32;)H="0"+H;for(var _=w(H),z=0;z<4;z++)f[M]=_[z],M+=1;for(var J=[],W=0,T=0;T<x.length;T++){for(var Y,$,Q=0,X=0;X<x[T];X++)Q+=L[W],W+=1;$=Math.sqrt(Q/x[T]),Y=20*Math.log10(255/$),J.push(Y)}for(var Z=0,ee=0;ee<J.length;ee++)Z+=J[ee];Z/=J.length,this.setState({psnrValue:Z}),this.setState({resultFilename:"result.avi"}),this.setState({resultVid:f})}}},{key:"LSBExtract",value:function(e,t,a,n){var r=new K.a;r.setSignature(e);for(var l=0,s=0;s<r.signature.subChunks.length;s++)if("JUNK"===r.signature.subChunks[s].chunkId){l=s;break}var o=r.signature.subChunks[l].chunkData.start,i=(r.signature.subChunks[l].chunkData.end,[]);i.push(e[o]);var u=(i=x(i))[6],c=i[7];u="0"===u?"random":"sequence",c="0"===c?"random":"sequence",l=o+1;for(var m=new Uint8Array(252),d=0;d<252;d++)m[d]=e[l],l+=1;for(var h=N(x(m)),g=new Uint8Array(4),f=0;f<252;f++)g[f]=e[l],l+=1;for(var v=8*parseInt(x(g),2),p=0,E=0;E<r.signature.subChunks.length;E++)if("LIST"===r.signature.subChunks[E].chunkId&&"movi"===r.signature.subChunks[E].format){p=E;break}for(var b=r.signature.subChunks[p].subChunks.length,y=[],S=0;S<b;S++)"d"===r.signature.subChunks[p].subChunks[S].chunkId[2]&&y.push(r.signature.subChunks[p].subChunks[S]);"random"===u&&(y=P.a.shuffle(y,n));for(var C=0,w=0,I=[];C<v;){for(var R=[],L=y[w].chunkData.start;L<y[w].chunkData.end;L++)R.push(L);"random"===c&&(R=P.a.shuffle(R,n)),I=I.concat(R),C+=y[w].chunkSize,w+=1}for(var U="",j=0;j<v;j++){U+=("000000000"+e[I[j]].toString(2)).substr(-8)[7]}U=U.match(/.{1,8}/g);for(var F=new Uint8Array(U.length),A=0;A<U.length;A++)F[A]=parseInt(U[A],2);t&&(F=k(F,a)),this.setState({resultFilename:h}),this.setState({resultVid:F})}},{key:"getSeedFromKey",value:function(e){for(var t=0,a=0;a<e.length;a++)t+=e.charCodeAt(a);return t}},{key:"render",value:function(){var e=this,t=this.state,a=(t.sourceVidURL,t.messageURL,t.resultVid),n=(t.resultVidURL,t.resultFilename),l=t.useEncryption,s=t.psnrValue;return r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,{onSubmit:this.handleSubmit,className:"margin-bottom-md"},r.a.createElement(i.a,null,r.a.createElement(u.a,{xs:4,className:"content-start"},r.a.createElement("div",{className:"content-center subheadline bold margin-bottom-xxl"},"Source Media"),r.a.createElement("div",{className:"body-text bold margin-bottom-sm"},"Choose source video"),r.a.createElement(p.a.Group,null,r.a.createElement(p.a.File,{id:"inputSourceVid",label:"Upload source video",onChange:function(t){return e.renderVid(t.target.files,"source")},accept:"video/avi"}))),r.a.createElement(u.a,{xs:4},r.a.createElement("div",{className:"content-center subheadline bold margin-bottom-xxl"},"File to Hide"),r.a.createElement("div",{className:"body-text bold margin-bottom-sm"},"Choose file to hide within source video"),r.a.createElement(p.a.Group,null,r.a.createElement(p.a.File,{id:"inputMessage",onChange:function(t){return e.renderVid(t.target.files,"message")}}))),r.a.createElement(u.a,{xs:4},r.a.createElement("div",{className:"content-center subheadline bold margin-bottom-xxl"},"Result Media"),r.a.createElement("div",{className:"body-text bold margin-bottom-sm"},"Download Result Video"),r.a.createElement(i.a,null,r.a.createElement("div",null,"Enter filename with extension")),r.a.createElement(i.a,null,r.a.createElement(u.a,{className:"no-indent"},r.a.createElement(p.a.Group,{controlId:"filenameField"},r.a.createElement(p.a.Control,{value:n,type:"text",onChange:function(t){e.saveFileName(t)}}))),r.a.createElement(u.a,{className:"no-indent"},r.a.createElement(E.a,{variant:"success",type:"button",className:"margin-bottom-xs",onClick:function(){return O(n,a)}}," ","Download Result"))),r.a.createElement("div",null,"PSNR: ",s))),r.a.createElement(i.a,null,r.a.createElement(u.a,null,r.a.createElement(p.a.Group,{controlId:"useEncryption"},r.a.createElement(p.a.Check,{type:"checkbox",label:"Use Encryption",onChange:this.toggleEncryption})),r.a.createElement(p.a.Group,{controlId:"key"},r.a.createElement(p.a.Label,null,"Encryption Key"),r.a.createElement(p.a.Control,{type:"text",readOnly:!l,ref:function(t){e.key=t}})),r.a.createElement(p.a.Group,{controlId:"frameOption"},r.a.createElement(p.a.Label,null,"Frame Option"),r.a.createElement(p.a.Control,{as:"select"},r.a.createElement("option",{value:"sequence"},"Sequential"),r.a.createElement("option",{value:"random"},"Random"))),r.a.createElement(p.a.Group,{controlId:"hidingOption"},r.a.createElement(p.a.Label,null,"Hiding Option"),r.a.createElement(p.a.Control,{as:"select"},r.a.createElement("option",{value:"sequence"},"Sequential"),r.a.createElement("option",{value:"random"},"Random"))),r.a.createElement(E.a,{variant:"primary",type:"submit",className:"full-width margin-bottom-xs",onClick:function(){return e.action="LSBEmbed"}}," ","Hide"),r.a.createElement(E.a,{variant:"info",type:"submit",className:"full-width",onClick:function(){return e.action="LSBExtract"}}," ","Extract")))))}}]),a}(r.a.PureComponent),H=a(10),_=a.n(H),z=a(19),J=a(11),W=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).toggleEncryption=function(e){a.setState({useEncryption:e.target.checked})},a.toggleHiding=function(e){a.setState({useRandom:"random"===e.target.value})},a.toggleHide=function(e){a.setState({hide:"hide"===e.target.value})},a.handleUpload=function(){var e=Object(z.a)(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=t.target.files).length>0&&a.setState({sourceFilename:n[0].name,audioSrc:URL.createObjectURL(n[0])});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.state={useEncryption:!1,useRandom:!1,hide:!0,audioSrc:"",audioResult:"",extractedMessage:"",sourceFilename:"",messageFilename:""},a.getFileName=a.getFileName.bind(Object(J.a)(a)),a.getMessage=a.getMessage.bind(Object(J.a)(a)),a.hideMessage=a.hideMessage.bind(Object(J.a)(a)),a.extractMessage=a.extractMessage.bind(Object(J.a)(a)),a.count_psnr=a.count_psnr.bind(Object(J.a)(a)),a}return Object(g.a)(n,[{key:"getMessage",value:function(){var e=Object(z.a)(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(t=document.getElementById("messageFile").files[0])){e.next=11;break}return e.t0=Uint8Array,e.next=5,M(t);case 5:return e.t1=e.sent,t=new e.t0(e.t1),this.state.useEncryption&&(t=y(t,document.getElementById("audiokey").value)),e.abrupt("return",t);case 11:alert("Please input message");case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getFileName",value:function(){var e=Object(z.a)(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(t=document.getElementById("messageFile").files[0])){e.next=5;break}return e.abrupt("return",t.name);case 5:alert("Please input message");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"hideMessage",value:function(){var e=Object(z.a)(_.a.mark((function e(t){var n,r,l,s,o,i,u,c,m,d,h,g,f,v,p,E;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this.state.useEncryption&&!this.state.useRandom){e.next=5;break}if(""!==document.getElementById("audiokey").value){e.next=5;break}return alert("please input key"),e.abrupt("return");case 5:return n=document.getElementById("inputSourceAudio").files,e.t0=Uint8Array,e.next=9,M(n[0]);case 9:return e.t1=e.sent,r=x(r=new e.t0(e.t1)),e.t2=x,e.next=15,this.getMessage();case 15:if(e.t3=e.sent,l=(0,e.t2)(e.t3),!(r.length<8*(l.length+2049))){e.next=20;break}return alert("message too large"),e.abrupt("return");case 20:return s="",this.state.useRandom?s+="0":s+="1",e.next=24,this.getFileName();case 24:if(o=I(o=e.sent),o="0".repeat(2016-o.length)+o,s+=o,i=(i=l.length/8).toString(2),i="0".repeat(32-i.length)+i,s+=i,s+=l,u=r.substr(0,359),c=359,this.state.useRandom){for((m=a(30).create()).seed(document.getElementById("audiokey").value);s.length>(c-351)/8-1&&c<16744;)(c+1)%8!==0||void 0===s.charAt((c-351)/8-1)||""===s.charAt((c-351)/8-1)?u+=r.charAt(c):u+=s.charAt((c-351)/8-1),c++;for(d=r.length-u.length,u+=r.substr(c,r.length-u.length),d/=8,h=new Set,g=0;g<l.length;g++){for(f=m(d+1);h.has(f);)f=m(d+1);h.add(f)}for(v=Array.from(h),u=u.split(""),p=0;p<l.length;p++)u[16751+8*v[p]]=l[p];u=u.join("")}else{for(;s.length>(c-351)/8-1;)(c+1)%8!==0||void 0===s.charAt((c-351)/8-1)||""===s.charAt((c-351)/8-1)?u+=r.charAt(c):u+=s.charAt((c-351)/8-1),c++;u+=r.substr(c,r.length-u.length)}u=C(u),E=new File([u],this.state.sourceFilename,{lastModified:document.getElementById("inputSourceAudio").files[0].lastModified,lastModifiedDate:document.getElementById("inputSourceAudio").files[0].lastModifiedDate}),this.setState({audioResult:URL.createObjectURL(E)}),this.count_psnr(C(r),u);case 40:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"count_psnr",value:function(e,t){for(var a=0,n=0;n<e.length;n++)a+=Math.pow(e[n]-t[n],2);var r=20*Math.log10(255/Math.sqrt(a/e.length));alert("PSNR : "+r.toFixed(2)+" dB")}},{key:"extractMessage",value:function(){var e=Object(z.a)(_.a.mark((function e(t){var n,r,l,s,o,i,u,c,m,d,h,g,f,v,p,E;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),this.state.useRandom||this.state.useEncryption||(document.getElementById("audiokey").value=""),!this.state.useEncryption&&!this.state.useRandom){e.next=6;break}if(""!==document.getElementById("audiokey").value){e.next=6;break}return alert("please input key"),e.abrupt("return");case 6:return n=document.getElementById("inputSourceAudio").files,e.t0=Uint8Array,e.next=10,M(n[0]);case 10:for(e.t1=e.sent,"0"===(r=x(r=new e.t0(e.t1))).charAt(359)?this.setState({useRandom:!0}):this.setState({useRandom:!1}),l="",s=0;s<2016;s++)l+=r.charAt(367+8*s);for(this.setState({messageFilename:N(l)}),o="",i=0;i<32;i++)o+=r.charAt(16495+8*i);if(o=8*parseInt(o,2),u="",!this.state.useRandom){e.next=35;break}if(""!==document.getElementById("audiokey").value){e.next=25;break}return alert("please input key"),e.abrupt("return");case 25:for((c=a(30).create()).seed(document.getElementById("audiokey").value),m=r.length-16744,m/=8,d=new Set,h=0;h<o;h++){for(g=c(m+1);d.has(g);)g=c(m+1);d.add(g)}for(f=Array.from(d),v=0;v<o;v++)u+=r.charAt(16751+8*f[v]);e.next=36;break;case 35:for(p=0;p<o;p++)u+=r.charAt(16751+8*p);case 36:if(u=C(u),!this.state.useEncryption){e.next=42;break}if(""!==document.getElementById("audiokey").value){e.next=41;break}return alert("please input key"),e.abrupt("return");case 41:u=k(u,document.getElementById("audiokey").value);case 42:E=new File([u],this.state.messageFilename),this.setState({extractedMessage:URL.createObjectURL(E)});case 44:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,{className:"margin-bottom-md"},r.a.createElement(i.a,null,r.a.createElement(u.a,{xs:4,className:"content-start"},r.a.createElement("div",{className:"content-center subheadline bold margin-bottom-sm"},"Source Media"),r.a.createElement("div",{className:"content-center full-width margin-bottom-xs"},r.a.createElement("audio",{src:this.state.audioSrc,controls:!0,controlsList:"nodownload"},"Your browser does not support the audio element.")),r.a.createElement(p.a.Group,null,r.a.createElement(p.a.File,{id:"inputSourceAudio",label:"Upload source audio",accept:"audio/wav",onChange:this.handleUpload}))),r.a.createElement(u.a,{xs:4},r.a.createElement("div",{className:"content-center subheadline bold margin-bottom-sm"},"Message"),r.a.createElement(i.a,null,r.a.createElement(p.a.Group,{hidden:!this.state.hide},r.a.createElement(p.a.File,{id:"messageFile"})),r.a.createElement(u.a,null,r.a.createElement("a",{href:this.state.extractedMessage,download:this.state.messageFilename},r.a.createElement(E.a,{variant:"success",type:"button",block:"inline",className:"margin-bottom-xs",hidden:this.state.hide,disabled:""===this.state.extractedMessage},"Download Message"))))),r.a.createElement(u.a,{xs:4,hidden:!this.state.hide},r.a.createElement("div",{className:"content-center subheadline bold margin-bottom-sm"},"Result Media"),r.a.createElement("div",{className:"content-center full-width margin-bottom-xs"},r.a.createElement("audio",{src:this.state.audioResult,controls:!0,controlsList:"nodownload"},"Your browser does not support the audio element.")),r.a.createElement(i.a,null,r.a.createElement(u.a,null,r.a.createElement("a",{href:this.state.audioResult,download:this.state.sourceFilename},r.a.createElement(E.a,{variant:"success",type:"button",block:"inline",className:"margin-bottom-xs",disabled:""===this.state.audioResult},"Download Result")))))),r.a.createElement(i.a,null,r.a.createElement(u.a,null,r.a.createElement(p.a.Group,{controlId:"useEncryption"},r.a.createElement(p.a.Check,{type:"checkbox",label:"Use Encryption",onChange:this.toggleEncryption})),r.a.createElement(p.a.Group,{controlId:"wantOption",onChange:this.toggleHide},r.a.createElement(p.a.Label,null,"What you want to do?"),r.a.createElement(p.a.Control,{as:"select"},r.a.createElement("option",{value:"hide"},"Hide message to media"),r.a.createElement("option",{value:"extract"},"Extract message from media"))),r.a.createElement(p.a.Group,{controlId:"audiokey",hidden:!this.state.useEncryption&&!this.state.useRandom},r.a.createElement(p.a.Label,null,"Encryption Key"),r.a.createElement(p.a.Control,{type:"text"})),r.a.createElement(p.a.Group,{controlId:"randomOption",onChange:this.toggleHiding,hidden:!this.state.hide},r.a.createElement(p.a.Label,null,"Hiding Option"),r.a.createElement(p.a.Control,{as:"select"},r.a.createElement("option",{value:"sequence"},"Sequential"),r.a.createElement("option",{value:"random"},"Random"))),r.a.createElement(E.a,{variant:"primary",type:"submit",className:"full-width margin-bottom-xs",hidden:!this.state.hide,onClick:this.hideMessage},"Hide"),r.a.createElement(E.a,{variant:"info",type:"submit",className:"full-width",hidden:this.state.hide,onClick:this.extractMessage},"Extract")))))}}]),n}(r.a.PureComponent);var T=function(){return r.a.createElement("div",null,r.a.createElement(d,null),r.a.createElement("div",{className:"content-fluid"},r.a.createElement(o.a.Container,{defaultActiveKey:"image-steganography"},r.a.createElement(i.a,null,r.a.createElement(u.a,{sm:2},r.a.createElement(c.a,{variant:"pills",className:"flex-column"},r.a.createElement(c.a.Item,null,r.a.createElement(c.a.Link,{eventKey:"image-steganography"},"Image Steganography")),r.a.createElement(c.a.Item,null,r.a.createElement(c.a.Link,{eventKey:"video-steganography"},"Video Steganography")),r.a.createElement(c.a.Item,null,r.a.createElement(c.a.Link,{eventKey:"audio-steganography"},"Audio Steganography")))),r.a.createElement(u.a,{sm:10,className:"content-center"},r.a.createElement(o.a.Content,{className:"full-width"},r.a.createElement(o.a.Pane,{eventKey:"image-steganography"},r.a.createElement(V,null)),r.a.createElement(o.a.Pane,{eventKey:"video-steganography"},r.a.createElement(q,null)),r.a.createElement(o.a.Pane,{eventKey:"audio-steganography"},r.a.createElement(W,null))))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(61);s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[40,1,2]]]);
//# sourceMappingURL=main.76b24a52.chunk.js.map